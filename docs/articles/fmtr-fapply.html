<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Format Apply Function • fmtr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Format Apply Function">
<meta property="og:description" content="fmtr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmtr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fmtr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fmtr-fdata.html">Format Data Function</a>
    </li>
    <li>
      <a href="../articles/fmtr-fapply.html">Format Apply Function</a>
    </li>
    <li>
      <a href="../articles/fmtr-fcat.html">Format Catalogs</a>
    </li>
    <li>
      <a href="../articles/fmtr-convenience.html">Convenience Functions</a>
    </li>
    <li>
      <a href="../articles/fmtr-helpers.html">Helper Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbosak01/fmtr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fmtr-fapply_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Format Apply Function</h1>
            
            <h4 class="date">2020-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/fmtr/blob/master/vignettes/fmtr-fapply.Rmd"><code>vignettes/fmtr-fapply.Rmd</code></a></small>
      <div class="hidden name"><code>fmtr-fapply.Rmd</code></div>

    </div>

    
    
<div id="how-to-use-fapply" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-use-fapply" class="anchor"></a>How to use fapply()</h3>
<p>The <code><a href="../reference/fapply.html">fapply()</a></code> function applies a format to a vector, factor, or list. This function may be used independently of the <code><a href="../reference/fdata.html">fdata()</a></code> function. Here is an example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"B"</span><span class="op">)</span>
<span class="va">v1</span>

<span class="co"># [1] "A" "B" "C" "B"</span>

<span class="va">fmt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/value.html">value</a></span><span class="op">(</span><span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"Label A"</span><span class="op">)</span>,
              <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"Label B"</span><span class="op">)</span>,
              <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="st">"Other"</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/fapply.html">fapply</a></span><span class="op">(</span><span class="va">v1</span>, <span class="va">fmt1</span><span class="op">)</span>

<span class="co"># "Label A" "Label B"   "Other" "Label B" </span></code></pre></div>
<p>One advantage of using <code><a href="../reference/fapply.html">fapply()</a></code> is that your original data is not altered. The formatted values are assigned to a new object. If your original data changes, the formatting function should be reapplied to maintain consistency with the original data.</p>
</div>
<div id="what-kind-of-formats-are-available" class="section level2">
<h2 class="hasAnchor">
<a href="#what-kind-of-formats-are-available" class="anchor"></a>What kind of formats are available</h2>
<p>Data can be formatted with several different types of objects: * A formatting string * A named vector * A user-defined format * A vectorized function * A formatting list</p>
<p>You can use the type of formatting object that is most suitable to your data and situation. Each type of formatting object has it’s own strengths and weaknesses.</p>
<div id="formatting-string" class="section level4">
<h4 class="hasAnchor">
<a href="#formatting-string" class="anchor"></a>Formatting String</h4>
<p>The formatting functions accept formatting strings such as those associated with the Base R <code>format</code> and <code>sprintf</code> functions. If the data type of the vector is a date or datetime, <code>fapply</code> will use the format codes associated with the <code>format</code> function. For other data types, <code>fapply</code> will use the format codes associated with <code>sprintf</code>. Here is an example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>v1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.367</span>, <span class="fl">8.356</span>, <span class="fl">4.583</span>, <span class="fl">2.873</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="kw">fapply</span>(v1, <span class="st">"%.1f%%"</span>)</span>
<span id="cb2-4"><a href="#cb2-4"></a></span>
<span id="cb2-5"><a href="#cb2-5"></a>[<span class="dv">1</span>] <span class="st">"1.4%"</span> <span class="st">"8.4%"</span> <span class="st">"4.6%"</span> <span class="st">"2.9%"</span></span></code></pre></div>
</div>
<div id="named-vectors" class="section level4">
<h4 class="hasAnchor">
<a href="#named-vectors" class="anchor"></a>Named vectors</h4>
<p>Data may be formatted using a named vector as a lookup. Simply ensure that the names on the formatting vector correspond to the values in the data vector.<br>
The advantage of using a named vector for formatting is its simplicity. The disadvantage is that it only works with character values. Here is an example of formatting using a named vector:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"B"</span><span class="op">)</span>

<span class="va">fmt1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>A <span class="op">=</span> <span class="st">"Label A"</span>, B <span class="op">=</span> <span class="st">"Label B"</span>, C<span class="op">=</span> <span class="st">"Label C"</span><span class="op">)</span>

<span class="fu"><a href="../reference/fapply.html">fapply</a></span><span class="op">(</span><span class="va">v1</span>, <span class="va">fmt1</span><span class="op">)</span>

<span class="co"># "Label A" "Label B" "Label C" "Label B" </span></code></pre></div>
</div>
<div id="user-defined-formats" class="section level4">
<h4 class="hasAnchor">
<a href="#user-defined-formats" class="anchor"></a>User-defined formats</h4>
<p>The <strong>fmtr</strong> package provides custom functions for creating user-defined formats, in a manner that is similar to a SAS® user-defined format. These functions are <code>value</code> and <code>condition</code>. The <code>value</code> function accepts one or more conditions. The <code>conditions</code> function accepts an expression/label pair. A user-defined format has the advantage of a clear and flexible syntax. It is excellent for categorizing data. Here is an example of a user-defined format:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="cn">NA</span>, <span class="st">"C"</span><span class="op">)</span>

<span class="va">fmt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/value.html">value</a></span><span class="op">(</span><span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"Missing"</span><span class="op">)</span>,
              <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"A"</span>, <span class="st">"Label A"</span><span class="op">)</span>,
              <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"B"</span>, <span class="st">"Label B"</span><span class="op">)</span>,
              <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="st">"Other"</span><span class="op">)</span><span class="op">)</span>
              
<span class="fu"><a href="../reference/fapply.html">fapply</a></span><span class="op">(</span><span class="va">v1</span>, <span class="va">fmt2</span><span class="op">)</span>

<span class="co"># "Label A" "Label B"   "Missing" "Other" </span></code></pre></div>
</div>
<div id="vectorized-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#vectorized-functions" class="anchor"></a>Vectorized functions</h4>
<p>Vectorized functions provide the most powerful way of formatting data. Vectorized functions can be user-defined, or wrapping an available packaged function. The vectorized function has the advantage of being nearly limitless in the types of formatting you can perform. The drawback is that a vectorized function can be more complicated to write. Here is an example of formatting with a user-defined, vectorized function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="cn">NA</span>, <span class="st">"C"</span><span class="op">)</span>

<span class="va">fmt2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Vectorize.html">Vectorize</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span>
    
    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> 
      <span class="va">ret</span> <span class="op">&lt;-</span> <span class="st">"Missing"</span>
    <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">x</span> <span class="op">%in%</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>
      <span class="va">ret</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Label"</span>, <span class="va">x</span><span class="op">)</span>
    <span class="kw">else</span> 
      <span class="va">ret</span> <span class="op">&lt;-</span> <span class="st">"Other"</span>
    
    <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">ret</span><span class="op">)</span>
    
  <span class="op">}</span><span class="op">)</span>
  
<span class="fu"><a href="../reference/fapply.html">fapply</a></span><span class="op">(</span><span class="va">v1</span>, <span class="va">fmt2</span><span class="op">)</span>

<span class="co"># "Label A" "Label B"   "Missing" "Other" </span></code></pre></div>
</div>
<div id="a-formatting-list" class="section level4">
<h4 class="hasAnchor">
<a href="#a-formatting-list" class="anchor"></a>A formatting list</h4>
<p>Sometimes data needs to be formatted differently for each row. This situation is difficult to deal with in any language.<br>
But it can be made easy in R with the <strong>fmtr</strong> package and a formatting list.</p>
<p>A formatting list is a list that contains one or more of the four types of formatting objects described above. A formatting list can be applied in two different ways: in order, or with a lookup.</p>
<p>By default, the list is applied in order. That means the first format in the list is applied to the first item in the vector, the second format in the list is applied to the second item in the vector, and so on. The list is recycled if the number of list items is shorter than the number of values in the vector.</p>
<p>For the lookup method, the formatting object is specified by a lookup vector. The lookup vector should contain names associated with the elements in the formatting list. The lookup vector should also contain the same number of items as the data vector. For each item in the data vector, <strong>fmtr</strong> will look up the appropriate format from the formatting list, and apply that format to the corresponding data value.</p>
<p>The following is an example of a lookup style formatting list:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set up data</span>
<span class="va">v1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"num"</span>, <span class="st">"char"</span>, <span class="st">"date"</span>, <span class="st">"char"</span>, <span class="st">"date"</span>, <span class="st">"num"</span><span class="op">)</span>
<span class="va">v2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fl">1.258</span>, <span class="st">"H"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-19"</span><span class="op">)</span>,
           <span class="st">"L"</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">"2020-04-24"</span><span class="op">)</span>, <span class="fl">2.8865</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>type <span class="op">=</span> <span class="va">v1</span>, values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html">I</a></span><span class="op">(</span><span class="va">v2</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span>

<span class="co">#    type     values</span>
<span class="co"># 1   num      1.258</span>
<span class="co"># 2  char          H</span>
<span class="co"># 3  date 2020-06-19</span>
<span class="co"># 4  char          L</span>
<span class="co"># 5  date 2020-04-24</span>
<span class="co"># 6   num     2.8865</span>

<span class="co"># Set up formatting list</span>
<span class="va">lst</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/flist.html">flist</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"row"</span>, lookup <span class="op">=</span> <span class="va">v1</span>,
             num <span class="op">=</span> <span class="st">"%.1f"</span>,
             char <span class="op">=</span> <span class="fu"><a href="../reference/value.html">value</a></span><span class="op">(</span><span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"H"</span>, <span class="st">"High"</span><span class="op">)</span>,
                          <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="va">x</span> <span class="op">==</span> <span class="st">"L"</span>, <span class="st">"Low"</span><span class="op">)</span>,
                          <span class="fu"><a href="../reference/condition.html">condition</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="st">"NA"</span><span class="op">)</span><span class="op">)</span>,
             date <span class="op">=</span> <span class="st">"%y-%m"</span><span class="op">)</span>

<span class="co"># Assign formatting list to values column</span>
<span class="fu"><a href="https://rdrr.io/r/base/attr.html">attr</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">values</span>, <span class="st">"format"</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">lst</span>


<span class="co"># Apply formatting</span>
<span class="fu"><a href="../reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>

<span class="co">#   type values</span>
<span class="co"># 1  num    1.3</span>
<span class="co"># 2 char   High</span>
<span class="co"># 3 date  20-06</span>
<span class="co"># 4 char    Low</span>
<span class="co"># 5 date  20-04</span>
<span class="co"># 6  num    2.9</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
