<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>fmtr • fmtr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="fmtr">
<meta property="og:description" content="fmtr">
<meta property="og:image" content="https://fmtr.r-sassy.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fmtr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/fmtr.html">Get started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/fmtr-fdata.html">Format Data Function</a>
    </li>
    <li>
      <a href="../articles/fmtr-fapply.html">Format Apply Function</a>
    </li>
    <li>
      <a href="../articles/fmtr-fcat.html">Format Catalogs</a>
    </li>
    <li>
      <a href="../articles/fmtr-convenience.html">Convenience Functions</a>
    </li>
    <li>
      <a href="../articles/fmtr-helpers.html">Helper Functions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dbosak01/fmtr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="fmtr_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>fmtr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dbosak01/fmtr/blob/master/vignettes/fmtr.Rmd"><code>vignettes/fmtr.Rmd</code></a></small>
      <div class="hidden name"><code>fmtr.Rmd</code></div>

    </div>

    
    
<p>The <strong>fmtr</strong> package helps format data. The package aims to simulate the basic functionality of SAS® formats, but with R. The package contains several functions that make formatting simpler and more powerful.</p>
<div id="key-functions" class="section level3">
<h3 class="hasAnchor">
<a href="#key-functions" class="anchor"></a>Key Functions</h3>
<p><strong>fmtr</strong> contains the following key functions:</p>
<ul>
<li>The <code><a href="../reference/fdata.html">fdata()</a></code> function to apply formatting to any data frame or tibble.</li>
<li>The <code><a href="../reference/fapply.html">fapply()</a></code> function to apply formatting to any vector.</li>
<li>The <code><a href="../reference/formats.html">formats()</a></code> and <code><a href="../reference/fattr.html">fattr()</a></code> functions to easily assign formatting attributes.</li>
<li>The <code><a href="../reference/value.html">value()</a></code> and <code><a href="../reference/condition.html">condition()</a></code> functions to create a user-defined format.</li>
<li>The <code><a href="../reference/fcat.html">fcat()</a></code> function to create a format catalog.</li>
<li>The <code><a href="../reference/flist.html">flist()</a></code> function to create a formatting list.</li>
</ul>
</div>
<div id="how-to-use" class="section level3">
<h3 class="hasAnchor">
<a href="#how-to-use" class="anchor"></a>How to Use</h3>
<p>The <strong>fmtr</strong> package builds heavily on existing R formatting capabilities. For most R programmers, these functions are well-known, and widely used. The examples below make use of standard R formatting codes, such as those associated with the <code><a href="https://rdrr.io/r/base/strptime.html">strptime()</a></code> and <code><a href="https://rdrr.io/r/base/sprintf.html">sprintf()</a></code> functions. The standard R formatting codes are a flexible and compact way of defining a format. If you are unfamiliar with R formatting codes, please see this summary on the <code><a href="../reference/FormattingStrings.html">FormattingStrings()</a></code> page.</p>
<div id="the-fapply-function" class="section level4">
<h4 class="hasAnchor">
<a href="#the-fapply-function" class="anchor"></a>The <code>fapply()</code> Function</h4>
<p>The simplest way to introduce the <strong>fmtr</strong> package is to examine the use of the <code><a href="../reference/fapply.html">fapply()</a></code> function.</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Create sample data vector
v1 &lt;- c(1.483, 5.29837, 7.9472, 8.684021)

# Apply format
fapply(v1, "%1.1f")
# [1] "1.5" "5.3" "7.9" "8.7"</a></code></pre>
<p>As you can see from the above example, the <code><a href="../reference/fapply.html">fapply()</a></code> function typically takes two parameters: a vector and a format. In this way, the <code><a href="../reference/fapply.html">fapply()</a></code> acts very much like a SAS® <code>put</code> function.</p>
<p>Note that the format parameter can also be assigned as an attribute on the vector. The <code><a href="../reference/fapply.html">fapply()</a></code> function will then pick up the format attribute, and apply it to the input vector. The result is the same:</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Create sample data vector
v1 &lt;- c(1.483, 5.29837, 7.9472, 8.684021)

# Assign format attribute
attr(v1, "format") &lt;- "%1.1f"

# Apply format
fapply(v1)
# [1] "1.5" "5.3" "7.9" "8.7"</a></code></pre>
<p>Besides the format attribute, the <code><a href="../reference/fapply.html">fapply()</a></code> function will also recognize attributes for <code>width</code> and <code>justify</code>. These parameters allow to you to control the width and alignment of the data in the vector. If the width parameter is larger than the width of the data, the value will be padded with spaces. Here is an example:</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Create sample data vector
v1 &lt;- c(1.483, 5.29837, 7.9472, 8.684021)

# Assign formatting attributes
attr(v1, "format") &lt;- "%1.1f"
attr(v1, "width") &lt;- 5
attr(v1, "justify") &lt;- "right"

# Apply formatting attributes
fapply(v1)
# [1] "  1.5" "  5.3" "  7.9" "  8.7"</a></code></pre>
<p>To help simplify assignment of these attributes, the <strong>fmtr</strong> package includes the <code><a href="../reference/fattr.html">fattr()</a></code> function, which allows you to set all the above attributes in one function call. Here is an example using the <code><a href="../reference/fattr.html">fattr()</a></code> function, that ends with the same result as the example above.</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Create sample data vector
v1 &lt;- c(1.483, 5.29837, 7.9472, 8.684021)

# Assign formatting attributes
v1 &lt;- fattr(v1, format = "%1.1f", width = 5, justify = "right")

# Apply formatting attributes
fapply(v1)
# [1] "  1.5" "  5.3" "  7.9" "  8.7"</a></code></pre>
<p>Note that <code><a href="../reference/fapply.html">fapply()</a></code> can accept several different types of formats. The examples above focus on a simple numeric format. But <code><a href="../reference/fapply.html">fapply()</a></code> also accepts date formats, a lookup list, a user-defined format, a vectorized function, and a formatting list.</p>
<p>Here is an example showing the use of a lookup list:</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Create sample data vector
v1 &lt;- c("A", "B", "A", "C", "B")

# Create lookup vector
v2 &lt;- c(A = "Group A", B = "Group B", C = "Group C")

fapply(v1, v2)
# [1] "Group A" "Group B" "Group A" "Group C" "Group B"</a></code></pre>
</div>
<div id="a-user-defined-format" class="section level4">
<h4 class="hasAnchor">
<a href="#a-user-defined-format" class="anchor"></a>A User-Defined Format</h4>
<p>The weakness with using a named vector as a lookup list, as in the above example, is that it will fail if there are any NA values in the data. Additionally, there is no capability to include any sort of logic in the lookup.</p>
<p>For these reasons, the <strong>fmtr</strong> package provides a <em>user-defined format</em>. This concept was taken directly from SAS® software. The functions that create a user-defined format are <code><a href="../reference/value.html">value()</a></code> and <code><a href="../reference/condition.html">condition()</a></code>.</p>
<p>A condition accepts an expression and a label. The expression determines which label is assigned. For the expression, you can use logical operators like “&amp;” and “|”, and relational operators like “&gt;” and “&lt;”. The data value is identified with a variable “x”. Here is an example:</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Create sample data vector
v1 &lt;- c("A", "B", "E", "A", NA, "C", "D")

u1 &lt;- value(condition(x == "A", "Group A"),
            condition(x == "B", "Group B"),
            condition(x == "C" | x == "D", "Group C/D"), 
            condition(TRUE, "Other"))
            
fapply(v1, u1)  
# [1] "Group A" "Group B" "Other" "Group A" "Other" "Group C/D" "Group C/D"</a></code></pre>
<p>Notice that the user-defined format gives you much more capabilities than a simple lookup vector. It allows you to perform categorization, and assign a default. Additionally, the NA missing value does not crash the function. The NA simply falls into the default category. If there is no default category, any values which do not correspond to a category will fall through the format unaltered.</p>
</div>
<div id="the-fdata-function" class="section level4">
<h4 class="hasAnchor">
<a href="#the-fdata-function" class="anchor"></a>The <code>fdata()</code> Function</h4>
<p>The <code><a href="../reference/fdata.html">fdata()</a></code> function works very much the same way as <code><a href="../reference/fapply.html">fapply()</a></code>, but with data frames and tibbles instead of vectors. In fact, under the hood, <code><a href="../reference/fdata.html">fdata()</a></code> is simply calling <code><a href="../reference/fapply.html">fapply()</a></code> for each column in the data frame.</p>
<p>Like the <code><a href="../reference/fapply.html">fapply()</a></code> function, formatting may be assigned to data frame columns using the <strong>format</strong>, <strong>width</strong>, and <strong>justify</strong> attributes. Formatting is then applied by calling the <code><a href="../reference/fdata.html">fdata()</a></code> function, and passing the data frame as the first parameter. <code><a href="../reference/fdata.html">fdata()</a></code> will then return a new data frame with the specified formatting applied. This method of formatting provides much greater control than the base R <code><a href="https://rdrr.io/r/base/format.html">format()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dbosak01/fmtr">fmtr</a></span><span class="op">)</span>

<span class="co"># Construct data frame from state vectors</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>state <span class="op">=</span> <span class="va">state.abb</span>, area <span class="op">=</span> <span class="va">state.area</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span>

<span class="co"># Calculate percentages</span>
<span class="va">df</span><span class="op">$</span><span class="va">pct</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">$</span><span class="va">area</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">state.area</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>

<span class="co"># Before formatting </span>
<span class="va">df</span>
<span class="co">#    state   area         pct</span>
<span class="co"># 1     AL  51609  1.42629378</span>
<span class="co"># 2     AK 589757 16.29883824</span>
<span class="co"># 3     AZ 113909  3.14804973</span>
<span class="co"># 4     AR  53104  1.46761040</span>
<span class="co"># 5     CA 158693  4.38572418</span>
<span class="co"># 6     CO 104247  2.88102556</span>
<span class="co"># 7     CT   5009  0.13843139</span>
<span class="co"># 8     DE   2057  0.05684835</span>
<span class="co"># 9     FL  58560  1.61839532</span>
<span class="co"># 10    GA  58876  1.62712846</span>

<span class="co"># Create state name lookup list</span>
<span class="va">name_lookup</span> <span class="op">&lt;-</span> <span class="va">state.name</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">name_lookup</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">state.abb</span>

<span class="co"># Assign formats</span>
<span class="fu"><a href="../reference/formats.html">formats</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>state <span class="op">=</span> <span class="va">name_lookup</span>,                         
                    area  <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html">format</a></span><span class="op">(</span><span class="va">x</span>, big.mark <span class="op">=</span> <span class="st">","</span><span class="op">)</span>, 
                    pct   <span class="op">=</span> <span class="st">"%.1f%%"</span><span class="op">)</span> 

<span class="co"># Apply formats</span>
<span class="fu"><a href="../reference/fdata.html">fdata</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#          state    area   pct</span>
<span class="co"># 1      Alabama  51,609  1.4%</span>
<span class="co"># 2       Alaska 589,757 16.3%</span>
<span class="co"># 3      Arizona 113,909  3.1%</span>
<span class="co"># 4     Arkansas  53,104  1.5%</span>
<span class="co"># 5   California 158,693  4.4%</span>
<span class="co"># 6     Colorado 104,247  2.9%</span>
<span class="co"># 7  Connecticut   5,009  0.1%</span>
<span class="co"># 8     Delaware   2,057  0.1%</span>
<span class="co"># 9      Florida  58,560  1.6%</span>
<span class="co"># 10     Georgia  58,876  1.6%</span></code></pre></div>
<p>In the above example, observe that the <code><a href="../reference/formats.html">formats()</a></code> function assigns the format attribute for multiple columns. This assignment is accomplished by sending a named list into the <code><a href="../reference/formats.html">formats()</a></code> function, where the names in the list correspond to the column names of the data frame. Also note the use of a lookup style format for the state names, and an anonymous vectorized format function for the state area.</p>
</div>
<div id="the-fcat-function" class="section level4">
<h4 class="hasAnchor">
<a href="#the-fcat-function" class="anchor"></a>The <code>fcat()</code> Function</h4>
<p>One of the benefits of the above method of formatting is that the data frame attributes can be stored with the data frame, and reapplied in the future. But what if you want to apply the same set of formats to a different data frame?</p>
<p>That is where you need a <em>format catalog</em>.</p>
<p>The format catalog is a collection of formats that can be saved and reused. A format catalog is created with an <code><a href="../reference/fcat.html">fcat()</a></code> function. To create a format catalog, you call the <code><a href="../reference/fcat.html">fcat()</a></code> function, passing a set of name/format pairs. In this case, the name of the format is a generic format name. It does not have to correspond to a column name. You may name the formats anything you want. The formats can be accessed in the catalog using dollar sign (“$”) list notation.</p>
<pre><code><a href="https://github.com/dbosak01/fmtr">library(fmtr)

# Construct data frame from state vectors
df &lt;- data.frame(state = state.abb, area = state.area)[1:10, ]

# Calculate percentages
df$pct &lt;- df$area / sum(state.area) * 100

# Before formatting 
df
#    state   area         pct
# 1     AL  51609  1.42629378
# 2     AK 589757 16.29883824
# 3     AZ 113909  3.14804973
# 4     AR  53104  1.46761040
# 5     CA 158693  4.38572418
# 6     CO 104247  2.88102556
# 7     CT   5009  0.13843139
# 8     DE   2057  0.05684835
# 9     FL  58560  1.61839532
# 10    GA  58876  1.62712846

# Create state name lookup list
name_lookup &lt;- state.name
names(name_lookup) &lt;- state.abb

# Assign formats to format catalog
cat1 &lt;- fcat(state = name_lookup,                         
             area  = function(x) format(x, big.mark = ","), 
             pct   = "%.1f%%") 
             
# Apply a format from the catalog using fapply
fapply(df$pct, cat1$pct)
# [1] "1.4%"  "16.3%" "3.1%"  "1.5%"  "4.4%"  "2.9%"  "0.1%"  "0.1%"  "1.6%"  "1.6%"

# Assign formats from the catalog to format attributes
formats(df) &lt;- cat1

# Apply formats
fdata(df)
#          state    area   pct
# 1      Alabama  51,609  1.4%
# 2       Alaska 589,757 16.3%
# 3      Arizona 113,909  3.1%
# 4     Arkansas  53,104  1.5%
# 5   California 158,693  4.4%
# 6     Colorado 104,247  2.9%
# 7  Connecticut   5,009  0.1%
# 8     Delaware   2,057  0.1%
# 9      Florida  58,560  1.6%
# 10     Georgia  58,876  1.6%
</a></code></pre>
<p>In normal use, of course, the format catalog would likely be created in a separate script and saved to a file using the <code><a href="../reference/write.fcat.html">write.fcat()</a></code> function. The format catalog can then be read by any number of programs using the <code><a href="../reference/read.fcat.html">read.fcat()</a></code> function, and the formats in the catalog can be applied as needed to your data.</p>
</div>
</div>
<div id="next-steps" class="section level3">
<h3 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next Steps</h3>
<p>For additional reinforcement of the topics presented above, please read the following articles:</p>
<ul>
<li><a href="fmtr-fdata.html">Format Data Function</a></li>
<li><a href="fmtr-fapply.html">Format Apply Function</a></li>
<li><a href="fmtr-fcat.html">Format Catalogs</a></li>
<li><a href="fmtr-convenience.html">Convenience Functions</a></li>
<li><a href="fmtr-helpers.html">Helper Functions</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by David Bosak.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
